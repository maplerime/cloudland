{{template "_head" .}}
    <div class="admin user">
        <div class="ui container">
            <div class="ui grid">
                {{template "_left" .}}
                <div class="twelve wide column content">
                    <h4 class="ui top attached header">
                        {{.i18n.Tr "CG_Manage_Panel"}} ({{.i18n.Tr "Total"}}: {{.Total}})
                        <div class="ui right">
                            <a class="ui green tiny button" href="/cgroups/new">{{.i18n.Tr "Create"}}</a>
                        </div>
                    </h4>
                    <div class="ui attached segment">
                        <form class="ui form">
                            <div class="ui fluid tiny action input">
                                <input name="q" value="{{ .Query }}" placeholder="Search..." autofocus>
                                <button class="ui blue tiny button">{{.i18n.Tr "Search"}}</button>
                            </div>
                        </form>
                    </div>
                    <div class="ui unstackable attached table segment">
                        <table class="ui unstackable very basic striped table">
                            <thead>
                                <tr>
                                    {{ if $.IsAdmin }}
                                    <th>{{.i18n.Tr "ID"}}</th>
                                    {{ end }}
                                    <th>{{.i18n.Tr "Name"}}</th>
                                    <th>{{.i18n.Tr "Description"}}</th>
                                    <th>{{.i18n.Tr "Status"}}</th>
                                    <th>{{.i18n.Tr "Volumes"}}</th>
                                    <th>{{.i18n.Tr "Snapshots"}}</th>
                                    {{ if $.IsAdmin }}
                                    <th>{{.i18n.Tr "Owner"}}</th>
                                    {{ end }}
                                    <th>{{.i18n.Tr "Actions"}}</th>
                                </tr>
                            </thead>
                            <tbody>
                                {{ $Link := .Link }}
                                {{ range .ConsistencyGroups }}
                                <tr>
                                    {{ if $.IsAdmin }}
                                    <td>{{.ID}}</td>
                                    {{ end }}
                                    <td><a href="/cgroups/{{.ID}}">{{.Name}}</a></td>
                                    <td>{{.Description}}</td>
                                    <td>{{.Status}}</td>
                                    <td>{{.VolumeCount}}</td>
                                    <td><a href="/cgroups/{{.ID}}/snapshots">{{.SnapshotCount}}</a></td>
                                    {{ if $.IsAdmin }}
                                    <td>{{ if .OwnerInfo }}{{.OwnerInfo.Name}}{{ end }}</td>
                                    {{ end }}
                                    <td>
                                        <div class="ui selection dropdown">
                                            <input id="action" name="action" type="hidden">
                                            <i class="dropdown icon"></i>
                                            <div class="default text">Action</div>
                                            <div class="menu">
                                                <div class="item" data-value="1" data-text="ViewDetails        ">
                                                    <a href="/cgroups/{{.ID}}/edit">{{$.i18n.Tr "View Details"}}        </a>
                                                </div>
                                                <div class="item" data-value="2" data-text="ManageVolumes        ">
                                                    <a href="/cgroups/{{.ID}}/volumes">{{$.i18n.Tr "Manage_Volumes"}}        </a>
                                                </div>
                                                <div class="item" data-value="3" data-text="Snapshots        ">
                                                    <a href="/cgroups/{{.ID}}/snapshots">{{$.i18n.Tr "Snapshots"}}        </a>
                                                </div>
                                                {{/* Allow delete when status is available or error, and has no snapshots */}}
                                                {{ if and (or (eq .Status.String "available") (eq .Status.String "error")) (eq .SnapshotCount 0) }}
                                                <div class="item" data-value="4" data-text="Delete        ">
                                                    <a class="delete-button" data-url="{{$Link}}/{{.ID}}" data-id="{{.ID}}" href="javascript:void(0)">{{$.i18n.Tr "Delete"}}        </a>
                                                </div>
                                                {{ end }}
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                                {{ end }}
                            </tbody>
                        </table>
                    </div>
                    <div class="ui attached segment">
                        {{ if .Pages}}
                        <div class="ui pagination menu">
                            {{ range $index, $element := .Pages }}
                            <a class="item" href="{{$Link}}?offset={{$element.Offset}}">{{ $element.Number }}</a>
                            {{ end }}
                        </div>
                        {{ end }}
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="ui small basic delete modal">
        <div class="ui icon header">
            <i class="trash icon"></i>
            {{.i18n.Tr "CG_Deletion"}}
        </div>
        <div class="content">
            <p>{{.i18n.Tr "CG_Deletion_Confirm"}}</p>
        </div>
        {{template "_delete_modal_actions" .}}
    </div>
{{template "_footer" .}}
